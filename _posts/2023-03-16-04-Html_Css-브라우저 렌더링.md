---
title:  "Html/Css 6장 - 브라우저 렌더링"
excerpt: "브라우저 렌더링"

categories: Html/Css
tags: [Html, Css, 브라우저]

toc: true
toc_sticky: true
 
date: 2023-03-16
last_modified_at: 2022-03-16
---
# Html/Css
## 브라우저 렌더링
- 브라우저 렌더링에서 렌더링이란, HTML, CSS, JavaScript 등 개발자가 작성한 문서가 브라우저에서 출력되는 과정을 의미한다.
- 브라우저는 기본적으로 렌더링을 수행하는 렌더링 엔진을 가지고 있다.

### 브라우저 렌더링 과정
![image](https://user-images.githubusercontent.com/118104644/225490624-5245ebba-d563-48cc-8618-c82ddf4c4293.png){:.center}

1. 사용자가 브라우저를 통해 웹 사이트에 접속한다.
2. 브라우저는 서버로부터 HTML,CSS,JavaScript와 같은 웹 사이트에 필요한 리소스를 다운받는다.
3. 렌더링 엔진은 전달받은 HTML 문서를 파싱해 DOM(문서 객체 모델)트리를 만든다.
4. 이어서 다운받은 외부 CSS파일과 함께 포함된 스타일 요소를 파싱해 CSSOM(CSS 객체 모델)트리를 만든다.
5. 만든 DOM트리와 CSSOM 트리를 결합해 Render 트리를 구축한다.
6. 레이아웃 과정을 통해 각 요소를 어디에 배치할지 결정한다.
7. 레이아웃 과정이 끝나면 UI 백엔드에서 Render 트리를 화면에 그리기 시작한다.
8. 이 과정을 paint라고 한다.

#### 파싱(Parsing)
- 프로그래밍 언어로 작성된 파일을 실행시키기 위해 구문 분석을 하는 단계이다.
- 파싱을 파서(parser)가 진행하며, 인프리터나 컴파일러 구성 요소 가운데 하나이다.
- 파서는 HTML파일의 코드를 문법적 의미를 갖는 최소 단위인 토큰으로 한 번 분해하고, 이 토큰들을 문법적 의미와 구조에 따라 노드라는 요소로 바꾼다.
- 노드들은 상하 관계에 따라 하나의 트리를 형성하는데 이를 파스 트리 혹은 문법 트리라고 부른다.
- 문서 파싱은 브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 것을 의미한다.
- 브라우저는 HTML 문서를 받자마자 DOM 트리로 파싱한다.
- HTML 토큰이 만들어지고, 이 토큰에는 시작 태그와 마침 태그가 포함되고, 속성 이름과 값도 포함된다.
- 토큰으로 변한 입력값은 파서에 의해 노드가 되고, 최종적으로 트리 구조의 DOM으로 구성이 된다.
- HTML문서를 파싱하면서 CSS 스타일을 만날 경우 텍스트를 CSS 스타일링 레이아웃과 페인팅에 사용하는 데이ㅓ 구조인 CSSOM 트리로 파싱하고, `<script>` 태그를 만날 경우 렌더링을 차단하면서 HTML파싱 또한 중단한다.
- `<script>` 태그 내 `src` 속성으로 연결된 파일을 다운받아 파싱하고 실행시킨 뒤 다시 HTML 파일을 파싱하기 시작한다.

#### DOM Tree
![image](https://user-images.githubusercontent.com/118104644/225491528-c6c0bf92-70a5-4089-9476-c3f79ce49757.png){:.center}
- DOM은 HTML 문서의 요소들의 중첩 관계를 기반으로 노드들을 트리 구조로 구성한 것을 의미하며, Document Object Model의 줄임말이다.
- 브라우저는 JavaScirpt언어만 알아듣기 때문에 HTML 태그나 속성들을 이해하지 못하며, 응답으로 받아온 HTML 문서는 텍스트로만 이뤄져 있다.
- 이해할 수 있는 형태인 객체로 바꿔주는 것이 DOM 트리이다.

#### CSSOM Tree
![image](https://user-images.githubusercontent.com/118104644/225491776-5d8fee65-17dd-42aa-b094-e2003b40c73a.png){:.center}
- HTML 파일을 DOM트리로 파싱하던 브라우저는 `<link>`,`<style>`태그를 만나게 되면 파싱을 멈추고 해당 리소스 파일을 서버로 요청한다.
- 요청한 파일을 HTML파일과 마찬가지로 파싱하는데, 파일을 파싱해 만든 트리를 CSSOM이라고 한다.
- CSSOM 트리를 구축하고 나면 브라우저는 다시 HTML파일의 파싱을 멈췄던 부분으로 돌아가서 마저 DOM트리를 구축한다.
- CSS는 부모의 속성을 자식이 상받는다.

#### Render Tree
![image](https://user-images.githubusercontent.com/118104644/225492392-5cf53ca3-fef0-4bed-9134-dcff987380fe.png){:.center}
- DOM트리와 CSSOM 트리는 트리 구조로 되어 있기 때문에 비슷하게 생겼지만, 리소스부터 다른 속성을 가진 독립적인 트리이다.
- 따라서 브라우저 위에 웹 사이트를 표시하기 위해 이 둘을 합치는 작업이 필요한하다.
- 랜더 트리는 렌더링을 목적으로 만들어지는 트리로, 렌더링은 사용자에게 브라우저가 보여주고자 하는 화면을 그리는 과정이므로, 보이지 않을 요소들은 이 트리에 포함시키지 않는다.
- `<meta>`, `display:none`과 같이 사용자에게 보여주지 않아도 되거나 보여주지 말아야 할 태그나 요소는 렌더 트리에서 제외된다.

#### 레이아웃
- 브라우저 렌더링에서 레이아웃 과정은, 평소 말하는 웹 ㅍ이지 레이아웃, 디자이너들의 레이아웃과는 다른 개념이다.
- 렌더 트리를 기반으로 HTML요소의 레이아웃(위치,크기)을 계산하여 화면 어디에 배치할지 결정하는 과정이다.
- DOM, CSSOM에 있던 속성들을 합쳐서 렌더 트리를 구성하는 것을 볼 수 있는데, 렌더 트리는 텍스트로 구성된 객체로만 보이기 때문에 페인팅이란 작업을 거쳐 브라우저 위에 그려지게 된다.
- 렌더 트리에는 CSSOM 트리에 있던 속성들이 합쳐져 있고 요소들의 크기,혹은 위치에 관련된 정보들이 들어 있다.
- 이 정보들은 각 요소에 관련된 정보일 뿐, 전체 화면에서 정확히 어디에 위치하는가에 대해 알지 못한다.
- 이런 계산을 브라우저의 렌더링 엔진이 한다.
- 브라우저는 각 요소가 전체 화면에서 어디에,어떤 크기로, 어떻게 배치되어야 하는지 파악하기 위해 렌더트리를 위에서 아래로 읽어 내려가며 모든 값은 절대값인 px로 변환된다.

#### 페인팅
- 위치에 대한 계산을 마치면 화면 위에 레이아웃에서 결정된 대로 그림을 그리기 시작한다.
- 각 정보를 가진 픽셀들이 모여 하나의 화면을 구성하며, 이 과정까지 해내야 텍스트에 불과했던 HTML 파일의 내용들이 이미지화된 모습으로 브라우저 화면에 띄어지는 것이다.